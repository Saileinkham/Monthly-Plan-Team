# ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ PWA + Push Notification

## ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
- PWA: ‡∏ó‡∏≥‡πÉ‡∏´‡πâ ‚Äú‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏Æ‡∏°‚Äù ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ö‡πÅ‡∏≠‡∏õ‡πÑ‡∏î‡πâ
- Push: ‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏°‡πâ‡∏õ‡∏¥‡∏î‡πÅ‡∏ó‡πá‡∏ö/‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ (‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö/‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ Web Push ‡∏ú‡πà‡∏≤‡∏ô Firebase Cloud Functions

‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å:
- PWA: `manifest.webmanifest`, `sw.js`, ‡πÇ‡∏Ñ‡πâ‡∏î‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô `script.js`
- Push (‡∏ù‡∏±‡πà‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå): `functions/index.js`

## 1) ‡∏™‡∏£‡πâ‡∏≤‡∏á VAPID Keys
‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏£‡∏±‡∏ô:
```bash
npx web-push generate-vapid-keys
```
‡∏à‡∏∞‡πÑ‡∏î‡πâ:
- Public Key
- Private Key

## 2) ‡πÉ‡∏™‡πà Public Key ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `firebase-config.js` ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤:
- `window.PUSH_VAPID_PUBLIC_KEY = "PUBLIC_KEY_..."`;

## 3) ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Private Key ‡πÉ‡∏ô Firebase Functions (‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏™‡πà‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö)
‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Firebase CLI ‡∏Å‡πà‡∏≠‡∏ô:
```bash
npm i -g firebase-tools
firebase login
```

‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô (‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå):
```bash
firebase use --add
firebase functions:config:set \
  webpush.vapid_public="PUBLIC_KEY_..." \
  webpush.vapid_private="PRIVATE_KEY_..." \
  webpush.subject="mailto:your@email.com" \
  webpush.admin_token="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏•‡∏±‡∏ö‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏¢‡∏¥‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö"
```

## 4) Deploy Functions
```bash
firebase deploy --only functions
```

‡∏à‡∏∞‡πÑ‡∏î‡πâ 3 ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô:
- `pushTest` (‡∏¢‡∏¥‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ URL)
- `pushDueSoon` (‡∏ó‡∏∏‡∏Å 5 ‡∏ô‡∏≤‡∏ó‡∏µ: ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 0‚Äì5 ‡∏ô‡∏≤‡∏ó‡∏µ)
- `pushDailySummary` (‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô 08:00: ‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ)

## 5) ‡πÄ‡∏õ‡∏¥‡∏î Push ‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö (‡∏ú‡πà‡∏≤‡∏ô HTTPS)
- ‡∏Å‡∏î üîî ‚Üí ‡∏Å‡∏î ‚Äú‡πÄ‡∏õ‡∏¥‡∏î‚Äù ‡πÉ‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ ‚ÄúPush ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‚Äù
- ‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö subscription ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà key:
- `<username>_pushSubscription`

## 6) ‡∏¢‡∏¥‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö Push
‡∏´‡∏•‡∏±‡∏á deploy ‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏ä‡πâ URL:
```
https://<REGION>-<PROJECT>.cloudfunctions.net/pushTest?token=<ADMIN_TOKEN>&user=<username>&title=‡∏ó‡∏î‡∏™‡∏≠‡∏ö&body=‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ
```

## 7) ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
### Android (Chrome)
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö ‚Üí ‡πÄ‡∏°‡∏ô‡∏π ‚Üí ‚ÄúAdd to Home screen‚Äù
- ‡πÄ‡∏õ‡∏¥‡∏î Push ‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ ‚Üí ‡∏õ‡∏¥‡∏î‡πÅ‡∏≠‡∏õ/‡∏•‡πá‡∏≠‡∏Å‡∏à‡∏≠ ‚Üí ‡∏•‡∏≠‡∏á‡∏¢‡∏¥‡∏á `pushTest`

### iPhone (Safari)
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ß‡πá‡∏ö ‚Üí Share ‚Üí ‚ÄúAdd to Home Screen‚Äù
- ‡πÄ‡∏õ‡∏¥‡∏î Push ‡πÉ‡∏ô‡πÅ‡∏≠‡∏õ
- ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏° Push ‡∏ö‡∏ô iOS ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î/‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô iOS ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Notification ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

## ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç
- Push ‡∏à‡∏∞ ‚Äú‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á‚Äù ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ Cloud Function ‡∏™‡πà‡∏á push ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ (schedule ‡∏´‡∏£‡∏∑‡∏≠ pushTest)
- ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å ‚Äú‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏á‡∏≤‡∏ô‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏°‡∏≤‡∏Å‚Äù (‡πÄ‡∏ä‡πà‡∏ô ‡∏ó‡∏∏‡∏Å‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏° timeStart) ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏±‡πâ‡∏á schedule ‡∏ñ‡∏µ‡πà‡∏Ç‡∏∂‡πâ‡∏ô/‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏≥‡∏Ñ‡∏¥‡∏ß‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Å‡∏¥‡∏à‡πÄ‡∏û‡∏¥‡πà‡∏°

